!function(){"use strict ";var n={defaults:{canvas:{background:"#fff"}}};window.Paint=n,n.BezierCurve=function(t,e,i){this.cp1=t||new n.Point,this.cp2=e||new n.Point,this.point=i||new n.Point},n.Canvas=function(t){n.Layer.call(this,t);var e=this,i=this.getCanvas(),o=(this.getContext(),new n.Layer),r={};this.undo=function(){this.getEnabledChildren().pop().enabled=!1,this.render()},this.redo=function(){this.getDisabledChildren().shift().enabled=!0,this.render()},this.showGrid=function(t,e,r){var a,h,s,d=i.width/(t.x+1),l=i.height/(t.y+1),f={line:{style:e||"rgba(0, 0, 0, 0.25)",width:r||1}};for(o.enabled=!0,o.clear(),a=1;a<t.x+1;a++)s=new n.Path(f),s.add(new n.Point(d*a,0)),s.add(new n.Point(d*a,i.height)),o.add(s);for(h=1;h<t.y+1;h++)s=new n.Path(f),s.add(new n.Point(0,l*h)),s.add(new n.Point(i.width,l*h)),o.add(s);this.render()},this.hideGrid=function(){o.enabled=!1},this.on=function(n,t){return n.indexOf(" ")>=0?void n.split(" ").forEach(function(n){e.on(n,t)}):(r[n]||(r[n]=[],i.addEventListener(n,function(t){for(var e=r[n].length;e--;)r[n][e].call(this,t)})),void r[n].push(t))},this.add(o),this.render()},n.Image=function(t,e){e||(e={}),this.position=e.position||new n.Point,this.size=e.size||new n.Point(t.width||0,t.height||0),this.render=function(n,e){e.drawImage(t,this.position.x,this.position.y,this.size.x,this.size.y)}},n.Layer=function(n){n||(n={});var t=document.createElement("canvas"),e=t.getContext("2d"),i=[];this.enabled=!0,this.add=function(n){i.push(n)},this.remove=function(n){var t;(t=i.indexOf(n))>-1&&i.splice(t,1)},this.clear=function(){i.length=0},this.render=function(o,r){if(this.enabled){var a;for(t.height=o?o.height:n.height,t.width=o?o.width:n.width,e.clearRect(0,0,t.width,t.height),a=0;a<i.length;a++)i[a].render(t,e);r&&r.drawImage(t,0,0)}},this.getEnabledChildren=function(){return i.filter(function(n){return n.enabled})},this.getDisabledChildren=function(){return i.filter(function(n){return!n.enabled})},this.getCanvas=function(){return t},this.getContext=function(){return e},this.getChildren=function(){return i}},n.Path=function(t){var e=[],i=new n.RenderOptions(t);t||(t={}),this.position=t.position||new n.Point,this.rotation=0,this.add=function(n){e.push(n)},this.remove=function(n){this.removeAt(e.indexOf(n))},this.removeLast=function(){e.unshift()},this.removeAt=function(n){e.splice(n,1)},this.render=function(o,r){var a;for(r.beginPath(),r.translate(this.position.x,this.position.y),r.rotate(this.rotation),a=0;a<e.length;a++)0===a&&r.moveTo(e[a].x,e[a].y),e[a]instanceof n.Point?r.lineTo(e[a].x,e[a].y):e[a]instanceof n.BezierCurve&&r.bezierCurveTo(e[a].cp1.x,e[a].cp1.y,e[a].cp2.x,e[a].cp2.y,e[a].point.x,e[a].point.y);t.close&&r.closePath(),i.render(o,r),r.setTransform(1,0,0,1,0,0)}},n.Path.getCircle=function(t,e){var i=4/3*Math.tan(Math.PI/8),o=new n.Path(e);return"number"==typeof t&&(t=new n.Point(t,t)),o.add(new n.Point(t.x,0)),o.add(new n.BezierCurve(new n.Point(t.x,i*t.y),new n.Point(i*t.x,t.y),new n.Point(0,t.y))),o.add(new n.BezierCurve(new n.Point(-i*t.x,t.y),new n.Point(-t.x,i*t.y),new n.Point(-t.x,0))),o.add(new n.BezierCurve(new n.Point(-t.x,-i*t.y),new n.Point(-i*t.x,-t.y),new n.Point(0,-t.y))),o.add(new n.BezierCurve(new n.Point(i*t.x,-t.y),new n.Point(t.x,-i*t.y),new n.Point(t.x,0))),o},n.Path.getRectangle=function(t,e){var i=new n.Path(e);return"number"==typeof t&&(t=new n.Point(t,t)),i.add(new n.Point(-.5*t.x,-.5*t.y)),i.add(new n.Point(.5*t.x,-.5*t.y)),i.add(new n.Point(.5*t.x,.5*t.y)),i.add(new n.Point(-.5*t.x,.5*t.y)),i.add(new n.Point(-.5*t.x,-.5*t.y)),i},n.Path.getTriangle=function(t,e){var i=new n.Path(e);return"number"==typeof t&&(t=new n.Point(t,t)),i.add(new n.Point(0,-1*t.y)),i.add(new n.Point(-.5*t.x,0)),i.add(new n.Point(.5*t.x,0)),i.add(new n.Point(0,-1*t.y)),i},n.Point=function(n,t){this.x=n||0,this.y=t||0},n.RenderOptions=function(n){n=n||{},n.line=n.line||{},this.render=function(t,e){e.fillStyle=n.fill||"#000",e.lineCap=n.line.cap||"butt",e.lineDashOffset=n.line.dashOffset||0,e.lineJoin=n.line.join||"miter",e.strokeStyle=n.line.style||"#000",e.lineWidth=n.line.width||0,n.fill&&"transparent"!==n.fill&&e.fill(),n.line.style&&"transparent"!==n.line.style&&n.line.width>0&&(e.setLineDash(n.line.dash||[]),e.stroke())}}}();